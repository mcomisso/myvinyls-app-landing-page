document.addEventListener("DOMContentLoaded",function(){initFAQAccordion(),initFAQSearch()});function initFAQAccordion(){const e=document.querySelectorAll(".faq-accordion-header");e.forEach(e=>{e.addEventListener("click",function(){const e=this.closest(".faq-accordion-item"),t=e.classList.contains("active");t?(e.classList.remove("active"),this.setAttribute("aria-expanded","false")):(e.classList.add("active"),this.setAttribute("aria-expanded","true"))})})}function initFAQSearch(){const e=document.getElementById("faq-search"),t=document.getElementById("faq-search-clear");if(!e)return;let n;e.addEventListener("input",function(){clearTimeout(n),n=setTimeout(()=>{filterFAQ(this.value.trim().toLowerCase()),t&&(t.style.display=this.value.length>0?"flex":"none")},200)}),t&&t.addEventListener("click",function(){e.value="",filterFAQ(""),this.style.display="none",e.focus()})}function filterFAQ(e){const t=document.querySelectorAll(".faq-category"),n=document.querySelector(".faq-quick-links");let o=0;const r=document.querySelector(".faq-no-results");if(r&&r.remove(),""===e)return t.forEach(t=>{t.classList.remove("hidden");const n=t.querySelectorAll(".faq-accordion-item");n.forEach(t=>{t.classList.remove("hidden"),t.classList.remove("active");const n=t.querySelector(".faq-accordion-header");n&&n.setAttribute("aria-expanded","false"),removeHighlights(t)})}),n&&n.classList.remove("hidden"),void 0;n&&n.classList.add("hidden"),t.forEach(t=>{const n=t.querySelectorAll(".faq-accordion-item");let r=0;n.forEach(t=>{const n=t.querySelector(".faq-accordion-header span"),s=t.querySelector(".faq-accordion-content"),c=n?n.textContent.toLowerCase():"",a=s?s.textContent.toLowerCase():"",l=t.querySelector(".faq-accordion-header");c.includes(e)||a.includes(e)?(t.classList.remove("hidden"),t.classList.add("active"),l&&l.setAttribute("aria-expanded","true"),r++,o++,n&&highlightText(n,e),s&&highlightTextInElement(s,e)):(t.classList.add("hidden"),t.classList.remove("active"),l&&l.setAttribute("aria-expanded","false"),removeHighlights(t))}),0===r?t.classList.add("hidden"):t.classList.remove("hidden")}),0===o&&showNoResults(e)}function highlightText(e,t){const n=e.textContent,o=new RegExp(`(${escapeRegExp(t)})`,`gi`);e.innerHTML=n.replace(o,'<mark class="faq-highlight">$1</mark>')}function highlightTextInElement(e,t){const n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),o=[];for(;n.nextNode();)o.push(n.currentNode);o.forEach(n=>{if(n.textContent.toLowerCase().includes(t)){const o=document.createElement("span"),r=new RegExp(`(${escapeRegExp(t)})`,`gi`);o.innerHTML=n.textContent.replace(r,'<mark class="faq-highlight">$1</mark>'),n.parentNode.replaceChild(o,n)}})}function removeHighlights(e){const t=e.querySelectorAll(".faq-highlight");t.forEach(e=>{const t=e.parentNode;t.replaceChild(document.createTextNode(e.textContent),e),t.normalize()});const n=e.querySelectorAll(".faq-accordion-content span");n.forEach(e=>{null===e.querySelector(".faq-highlight")&&1===e.childNodes.length&&e.firstChild.nodeType===Node.TEXT_NODE&&e.parentNode.replaceChild(document.createTextNode(e.textContent),e)})}function showNoResults(e){const t=document.querySelector(".faq-page-section .container");if(!t)return;const n=document.createElement("div");n.className="faq-no-results",n.innerHTML=`        <i class="fas fa-search"></i>
        <h3>No results found</h3>
        <p>We couldn't find any answers matching "${escapeHtml(e)}". Try different keywords or browse the categories above.</p>
    `,t.appendChild(n)}function escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}document.querySelectorAll(".faq-quick-link").forEach(e=>{e.addEventListener("click",function(t){const n=this.getAttribute("href");if(n&&n.startsWith("#")){t.preventDefault();const o=document.querySelector(n);if(o){const t=document.getElementById("faq-search"),n=document.getElementById("faq-search-clear");t&&(t.value="",filterFAQ("")),n&&(n.style.display="none"),o.scrollIntoView({behavior:"smooth",block:"start"})}}})});
